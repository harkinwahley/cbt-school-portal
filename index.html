<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excellence Academy CBT Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #006b3c; --secondary: #e9f7ef; --accent: #d35400; --text: #333; --white: #ffffff; }
        body { font-family: 'Comic Neue', cursive; background-color: #f4f4f4; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { background: var(--white); width: 90%; max-width: 600px; padding: 30px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; border-top: 5px solid var(--primary); }
        .hidden { display: none; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn { background-color: var(--primary); color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin: 5px; }
        .btn-subject { width: 100%; margin: 5px 0; padding: 12px; font-size: 16px; text-align: left; }
        #timer-box { background: var(--accent); color: white; padding: 8px 15px; border-radius: 5px; font-weight: bold; }
        .option-label { display: block; background: var(--secondary); padding: 12px; margin: 8px 0; border-radius: 8px; cursor: pointer; text-align: left; border: 1px solid #cce5d9; }
        .nav-btns { display: flex; justify-content: space-between; align-items: center; margin-top: 20px; }
        #feedback-box { text-align: left; background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 20px; border: 1px solid #ffeeba; }
    </style>
</head>
<body>

    <div id="section-register" class="container">
        <h1>ğŸ“ Excellence Academy</h1>
        <p>JAMB Standard Practice Portal</p>
        <input type="text" id="reg-name" placeholder="Enter Full Name">
        <input type="text" id="reg-class" placeholder="Class (e.g., SS3)">
        <button class="btn" onclick="registerStudent()">Enter Dashboard</button>
    </div>

    <div id="section-dashboard" class="container hidden">
        <h2 id="welcome-msg">Welcome</h2>
        <p>Select Subject (20 Questions | 10 Mins)</p>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <button class="btn btn-subject" onclick="startExam('math')">ğŸ§® Math</button>
            <button class="btn btn-subject" onclick="startExam('english')">ğŸ“– English</button>
            <button class="btn btn-subject" onclick="startExam('physics')">âš›ï¸ Physics</button>
            <button class="btn btn-subject" onclick="startExam('chemistry')">ğŸ§ª Chemistry</button>
            <button class="btn btn-subject" onclick="startExam('biology')">ğŸ§¬ Biology</button>
            <button class="btn btn-subject" onclick="startExam('government')">ğŸ›ï¸ Government</button>
            <button class="btn btn-subject" onclick="startExam('economics')">ğŸ“ˆ Economics</button>
            <button class="btn btn-subject" onclick="startExam('commerce')">ğŸ›’ Commerce</button>
            <button class="btn btn-subject" onclick="startExam('accounting')">ğŸ’° Accounting</button>
            <button class="btn btn-subject" onclick="startExam('literature')">ğŸ“š Literature</button>
            <button class="btn btn-subject" onclick="startExam('crs')">âœï¸ CRS</button>
        </div>
    </div>

    <div id="section-exam" class="container hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom:20px;">
            <span id="subject-title" style="font-weight:bold; color:var(--primary)"></span>
            <div id="timer-box">â³ <span id="time-left">10:00</span></div>
        </div>
        <div id="question-container">
            <h3 id="q-text" style="text-align: left;"></h3>
            <div id="options-container"></div>
        </div>
        <div class="nav-btns">
            <button class="btn" style="background:#555" onclick="prevQuestion()">Back</button>
            <div id="q-status">1 of 20</div>
            <button class="btn" id="btn-next" onclick="nextQuestion()">Next</button>
        </div>
    </div>

    <div id="section-result" class="container hidden">
        <h2>ğŸ“Š Exam Results</h2>
        <p>Student: <b id="res-name"></b> | Subject: <b id="res-subject"></b></p>
        <div style="font-size: 45px; color: var(--primary); margin: 15px 0;">
            <span id="res-score">0</span> / 20
        </div>
        <p id="res-percent" style="font-weight:bold; font-size: 20px;"></p>
        
        <div id="feedback-box" class="hidden">
            <h4 style="margin: 0 0 10px 0; color: #856404;">ğŸ’¡ Recommended Study Areas:</h4>
            <ul id="topic-suggestions" style="margin: 0; padding-left: 20px; line-height: 1.6;"></ul>
        </div>
        <br>
        <button class="btn" onclick="location.reload()">Try Another Subject</button>
    </div>

    <script src="questions.js"></script>
    <script>
        let currentUser = {}, currentSubject = '', currentQuestions = [], userAnswers = [], currentQIndex = 0, timerInterval;

        function registerStudent() {
            const name = document.getElementById('reg-name').value;
            if(!name) return alert("Enter your name");
            currentUser = { name: name };
            document.getElementById('welcome-msg').innerText = `Hello, ${name}`;
            switchSection('section-dashboard');
        }

        function startExam(subject) {
            currentSubject = subject;
            const allQuestions = questionBank[subject];
            if (!allQuestions) return alert("Subject data missing!");

            currentQuestions = shuffleArray(allQuestions).slice(0, 20);
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQIndex = 0;

            document.getElementById('subject-title').innerText = subject.toUpperCase();
            switchSection('section-exam');
            loadQuestion(0);
            startTimer(10 * 60); // 10 minutes
        }

        function loadQuestion(index) {
            const q = currentQuestions[index];
            document.getElementById('q-text').innerText = `${index + 1}. ${q.question}`;
            document.getElementById('q-status').innerText = `${index + 1} of ${currentQuestions.length}`;
            const optsDiv = document.getElementById('options-container');
            optsDiv.innerHTML = '';

            q.options.forEach((opt, i) => {
                const checked = userAnswers[index] === i ? 'checked' : '';
                optsDiv.innerHTML += `
                    <label class="option-label">
                        <input type="radio" name="option" value="${i}" onclick="saveAnswer(${i})" ${checked}>
                        <span>${opt}</span>
                    </label>`;
            });

            const nextBtn = document.getElementById('btn-next');
            nextBtn.innerText = (index === currentQuestions.length - 1) ? "Submit" : "Next";
            nextBtn.onclick = (index === currentQuestions.length - 1) ? submitExam : nextQuestion;
        }

        function saveAnswer(i) { userAnswers[currentQIndex] = i; }
        function nextQuestion() { if(currentQIndex < currentQuestions.length - 1) { currentQIndex++; loadQuestion(currentQIndex); } }
        function prevQuestion() { if(currentQIndex > 0) { currentQIndex--; loadQuestion(currentQIndex); } }

        function startTimer(t) {
            const display = document.getElementById('time-left');
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                let m = Math.floor(t / 60), s = t % 60;
                display.textContent = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                if (--t < 0) submitExam();
            }, 1000);
        }

        function submitExam() {
            clearInterval(timerInterval);
            let score = 0, missedTopics = [];
            currentQuestions.forEach((q, i) => {
                if(userAnswers[i] === q.answer) score++;
                else { if(q.topic && !missedTopics.includes(q.topic)) missedTopics.push(q.topic); }
            });

            document.getElementById('res-name').innerText = currentUser.name;
            document.getElementById('res-subject').innerText = currentSubject.toUpperCase();
            document.getElementById('res-score').innerText = score;
            const pct = (score / currentQuestions.length) * 100;
            document.getElementById('res-percent').innerText = `${pct}%`;
            document.getElementById('res-percent').style.color = pct >= 50 ? 'green' : 'red';

            const fb = document.getElementById('feedback-box');
            if(missedTopics.length > 0) {
                fb.classList.remove('hidden');
                document.getElementById('topic-suggestions').innerHTML = missedTopics.map(t => `<li>${t}</li>`).join('');
            } else { fb.classList.add('hidden'); }

            switchSection('section-result');
        }

        function switchSection(id) {
            document.querySelectorAll('.container').forEach(d => d.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function shuffleArray(arr) {
            let s = [...arr];
            for (let i = s.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [s[i], s[j]] = [s[j], s[i]];
            }
            return s;
        }
    </script>
</body>
</html>
